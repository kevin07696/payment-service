<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EPX Browser Post Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
        }
        button:hover {
            background-color: #45a049;
        }
        .note {
            background-color: #f0f0f0;
            padding: 15px;
            border-radius: 4px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>EPX Browser Post Test Payment</h1>

    <div class="note">
        <strong>Test Card Numbers:</strong><br>
        Visa: 4111111111111111<br>
        Mastercard: 5499740000000057<br>
        CVV: Any 3 digits (e.g., 123)<br>
        Expiry: Any future date (e.g., 12/2025)
    </div>

    <form method="POST" action="https://secure.epxuap.com/browserpost">
        <!-- EPX Credentials (Hidden) -->
        <input type="hidden" name="CUST_NBR" value="9001" />
        <input type="hidden" name="MERCH_NBR" value="900300" />
        <input type="hidden" name="DBA_NBR" value="2" />
        <input type="hidden" name="TERMINAL_NBR" value="77" />

        <!-- Transaction Details (Hidden) -->
        <input type="hidden" name="TRAN_CODE" value="SALE" />
        <input type="hidden" name="INDUSTRY_TYPE" value="E" />
        <input type="hidden" name="TRAN_NBR" id="tran_nbr" value="" />
        <input type="hidden" name="BATCH_ID" id="batch_id" value="" />
        <input type="hidden" name="AMOUNT" value="1.00" />
        <input type="hidden" name="TRAN_GROUP" value="SALE" />
        <input type="hidden" name="CARD_ENT_METH" value="E" />

        <!-- Callback URL (Hidden) -->
        <input type="hidden" name="REDIRECT_URL" value="http://localhost:8081/api/v1/payments/browser-post/callback" />

        <!-- NOTE: TAC field would normally be required, but depends on your EPX setup -->
        <!-- If EPX requires TAC, you need to generate it first via EPX API or backend -->

        <!-- Card Details (User Input) -->
        <div class="form-group">
            <label for="card_nbr">Card Number:</label>
            <input type="text" id="card_nbr" name="CARD_NBR" placeholder="4111111111111111" maxlength="16" required />
        </div>

        <div class="form-group">
            <label for="exp_month">Expiry Month (MM):</label>
            <input type="text" id="exp_month" name="EXP_MONTH" placeholder="12" maxlength="2" required />
        </div>

        <div class="form-group">
            <label for="exp_year">Expiry Year (YYYY):</label>
            <input type="text" id="exp_year" name="EXP_YEAR" placeholder="2025" maxlength="4" required />
        </div>

        <div class="form-group">
            <label for="cvv">CVV:</label>
            <input type="text" id="cvv" name="CVV" placeholder="123" maxlength="4" required />
        </div>

        <div class="form-group">
            <label for="first_name">First Name:</label>
            <input type="text" id="first_name" name="FIRST_NAME" placeholder="John" />
        </div>

        <div class="form-group">
            <label for="last_name">Last Name:</label>
            <input type="text" id="last_name" name="LAST_NAME" placeholder="Doe" />
        </div>

        <button type="submit">Pay $1.00</button>
    </form>

    <script>
        // Generate unique transaction number on page load
        const timestamp = Math.floor(Date.now() / 1000) % 100000; // 5 digits
        document.getElementById('tran_nbr').value = timestamp.toString();
        document.getElementById('batch_id').value = timestamp.toString();

        // Update on form submission to ensure uniqueness
        document.querySelector('form').addEventListener('submit', function() {
            const newTimestamp = Math.floor(Date.now() / 1000) % 100000;
            document.getElementById('tran_nbr').value = newTimestamp.toString();
            document.getElementById('batch_id').value = newTimestamp.toString();
        });
    </script>
</body>
</html>
